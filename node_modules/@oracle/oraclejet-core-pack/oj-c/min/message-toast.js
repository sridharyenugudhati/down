define("oj-c/hooks/UNSAFE_useDataProvider/utils",["require","exports"],(function(require,t){"use strict";function e(t,e,a,s){const o=[...s];return t.forEach(((t,s)=>{const r={data:e[s],key:a[s]?.key,metadata:a[s]};t>=0?o.splice(t,0,r):o.push(r)})),o}async function a(t,e){const a=[],s=(await t.fetchByKeys({keys:e})).results;for(const t of e)if(s.has(t)){const e=s.get(t);a.push({...e,key:t})}return a}function s(t,e){return t.has(e)?t.get(e):-1}function o(t,e){const a=[...e];return t.sort(((t,e)=>e-t)),t.forEach((t=>{t<a.length&&a.splice(t,1)})),a}Object.defineProperty(t,"__esModule",{value:!0}),t.getUpdatedItemsFromMutationDetail=void 0,t.getUpdatedItemsFromMutationDetail=async function(t,r,n){const{add:i,remove:d,update:c}=t??{},u=new Map;for(const[t,e]of r.entries())u.set(e.key,t);let l=[...r];return d&&(l=function(t,e,a){const{indexes:r,keys:n}=t;let i=[...e];r?.length?i=o(r,i):n?.size&&(i=function(t,e,a){const r=[];return t.forEach((t=>{const e=s(a,t);-1!==e&&r.push(e)})),o(r,e)}(n,i,a));return i}(d,l,u)),i&&(l=await async function(t,o,r,n){const{addBeforeKeys:i,data:d,indexes:c,keys:u,metadata:l}=t;let f=[...o],h=d||[],p=l||[];if(0===h.length&&u?.size){const t=await a(n,u)??[];h=t.map((t=>t.data)),p=t.map((t=>t.metadata))}0===p.length&&u?.size&&(p=[...u].map((t=>({key:t}))));h.length&&(f=c?.length?e(c,h,p,f):i?.length?function(t,a,o,r){const n=[],i=[];return t.forEach((t=>{n.push(s(r,t)),i.push({key:t})})),e(n,a,i,o)}(i,h,f,r):function(t,a,s){return e(new Array(t.length).fill(-1),t,a,s)}(h,p,f));return f}(i,l,u,n)),c&&(l=await async function(t,e,o,r){const{data:n,indexes:i,keys:d,metadata:c}=t;let u=[...e],l=n||[],f=c||[];if(0===l.length&&d?.size){const t=await a(r,d)??[];l=t.map((t=>t.data)),f=t.map((t=>t.metadata))}0===f.length&&d?.size&&(f=[...d].map((t=>({key:t}))));l.length&&(i?.length?u=function(t,e,a,s){const o=[...s];return t.forEach(((t,s)=>{if(o[t]){const r={data:e[s],key:a[s]?.key,metadata:a[s]};o.splice(t,1,r)}})),o}(i,l,f,u):d?.size&&(u=function(t,e,a,o,r){const n=[...o];return t.forEach((t=>{const o=s(r,t),i={data:e[o],key:a[o]?.key,metadata:a[o]};o>=0&&n.splice(o,1,i)})),n}(d,l,f,u,o)));return u}(c,l,u,n)),l}})),define("oj-c/hooks/UNSAFE_useDataProvider/DataProviderHandler",["require","exports","./utils"],(function(require,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DataProviderHandler=void 0;t.DataProviderHandler=class{constructor(t,a,s){this.handleMutateEvent=async t=>{const{detail:a}=t,s=this.addBusyState("updating data from mutation event"),o=await(0,e.getUpdatedItemsFromMutationDetail)(a,this.currentData,this.dataProvider);s?.(),this.currentData=o,this.callback?.onDataUpdated?.(o)},this.handleRefreshEvent=()=>{this._fetchDataAndNotify()},this.addBusyState=a,this.callback=s,this.dataProvider=t,this.currentData=[],t.addEventListener("refresh",this.handleRefreshEvent),t.addEventListener("mutate",this.handleMutateEvent),this._fetchDataAndNotify()}destroy(){this.callback=void 0,this.currentData=[],this.dataProvider.removeEventListener("refresh",this.handleRefreshEvent),this.dataProvider.removeEventListener("mutate",this.handleMutateEvent)}async _fetchData(){const t=[],e=this.dataProvider.fetchFirst({size:-1});for await(const a of e){const e=a.data.map(((t,e)=>({data:t,key:a.metadata[e].key,metadata:a.metadata[e]})));t.push(...e)}return this.currentData=t.slice(),t}async _fetchDataAndNotify(){const t=this.addBusyState("fetching data"),e=await this._fetchData();this.callback?.onDataUpdated?.(e),t()}}})),define("oj-c/hooks/UNSAFE_useDataProvider/useDataProvider",["require","exports","preact/hooks","./DataProviderHandler"],(function(require,t,e,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useDataProvider=void 0,t.useDataProvider=function({addBusyState:t,data:s}){const[o,r]=(0,e.useState)([]),n=(0,e.useRef)();return(0,e.useEffect)((()=>(void 0!==s&&(n.current=new a.DataProviderHandler(s,t,{onDataUpdated:r})),()=>{n.current?.destroy(),n.current=void 0})),[s,t]),{data:o}}}));var __importDefault=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};define("oj-c/message-toast/message-toast",["require","exports","preact/jsx-runtime","@oracle/oraclejet-preact/translationBundle","@oracle/oraclejet-preact/hooks/UNSAFE_useMessagesContext","@oracle/oraclejet-preact/UNSAFE_MessageToast","oj-c/hooks/UNSAFE_useDataProvider/useDataProvider","ojs/ojvcomponent","preact/hooks","ojs/ojcontext","css!oj-c/message-toast/message-toast-styles.css"],(function(require,t,e,a,s,o,r,n,i,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MessageToast=void 0,a=__importDefault(a),t.MessageToast=(0,n.registerCustomElement)("oj-c-message-toast",(function({data:t,detailTemplateValue:a,iconTemplateValue:c,messageTemplates:u,offset:l=0,position:f="bottom",onOjClose:h}){const p=(0,i.useRef)((0,n.getUniqueId)()),m=(0,i.useRef)(),[y,v]=(0,i.useState)(t),[g,D]=(0,i.useState)(0),_=(0,i.useCallback)(((t="MessageToast: busyState")=>m.current?d.getContext(m.current).getBusyContext().addBusyState({description:t}):()=>{}),[]);t!=y&&(v(t),D((t=>t+1)));const{data:k}=(0,r.useDataProvider)({data:t,addBusyState:_}),j=`messageToastLayer_${p.current}`,E=(0,i.useMemo)((()=>({addBusyState:_,UNSAFE_messagesLayerId:j})),[_,j]);return(0,e.jsx)(n.Root,{ref:m,"data-oj-messages-layer-id":j,children:(0,e.jsx)(s.MessagesContext.Provider,{value:E,children:(0,e.jsx)(o.MessageToast,{data:k,detailRendererKey:a,iconRendererKey:c,offset:l,onClose:h,position:f,renderers:u},g)})})}),"MessageToast",{properties:{data:{type:"DataProvider"},detailTemplateValue:{type:"string|function"},iconTemplateValue:{type:"string|function"},offset:{type:"number|object"},position:{type:"string",enumValues:["bottom","top","top-start","top-end","bottom-start","bottom-end","top-left","bottom-left","top-right","bottom-right"]}},extension:{_DYNAMIC_SLOT:{prop:"messageTemplates",isTemplate:1}},events:{ojClose:{}}},{offset:0,position:"bottom"},{"@oracle/oraclejet-preact":a.default})}));
//# sourceMappingURL=message-toast.js.map