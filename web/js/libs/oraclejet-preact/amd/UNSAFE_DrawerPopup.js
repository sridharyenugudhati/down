define(['exports', 'preact/jsx-runtime', 'preact/hooks', './UNSAFE_Layer', './UNSAFE_Modal', './UNSAFE_FocusTrap', './utils/PRIVATE_tabbableUtils', './utils/PRIVATE_floatingUtils', './utils/PRIVATE_clientHints', './hooks/UNSAFE_useOutsideClick', './hooks/UNSAFE_useAnimation', './hooks/UNSAFE_useUser', './hooks/UNSAFE_useComponentTheme', './utils/UNSAFE_interpolations/colors', './utils/UNSAFE_mergeInterpolations', './UNSAFE_DrawerPopup/themes/redwood/DrawerPopupTheme', './useAnimation-bc5efb9f', './clientHints-dd589985', './FocusTrap-47f31a06', './Modal-4ef555ef', 'preact/compat', './index-abd879ef', 'preact', './Common', './Common/themes', './Common/themes/redwood/theme', './Common/themes/themeContract.css', './useThemeInterpolations-35281d48', './hooks/UNSAFE_useColorScheme', './hooks/UNSAFE_useScale', './utils/UNSAFE_interpolations/theme', './UNSAFE_Theme', './utils-b994552d', './utils/UNSAFE_classNames', './classNames-bd4a4c19', './_curry1-4d9a6584', './_curry3-963d734c', './_curry2-99f10bc7', './_has-77ad1af6', './useModal-86e2eab9', './UNSAFE_Modal/themes/ModalStyles.css', 'css!./ModalStyles.styles.css', './vanilla-extract-recipes-createRuntimeFn.esm-84f316bc', 'module', './_arity-39916028', './utils/UNSAFE_arrayUtils', './utils/UNSAFE_logger', './UNSAFE_DrawerPopup/themes/redwood/DrawerPopupBaseTheme.css', 'module', './UNSAFE_DrawerPopup/themes/DrawerPopupStyles.css', 'css!./DrawerPopupStyles.styles.css', './UNSAFE_DrawerPopup/themes/redwood/DrawerPopupVariants.css', 'css!./DrawerPopupVariants.styles.css'], (function(e,t,o,s,n,r,a,i,l,u,c,d,m,p,h,f,b,y,E,S,A,_,F,w,U,g,v,N,P,D,C,k,T,x,M,R,O,I,j,H,V,L,X,Y,z,B,W,$,K,q,G,J,Q){"use strict";const Z="0px",ee=250;e.DrawerPopup=({children:e,isOpen:n=!1,autoFocusRef:r,placement:l="start",modality:c="modal",onClose:A,onTransitionEnd:_,"aria-label":F,"aria-labelledby":w,"aria-describedby":U,...g})=>{const[v,N]=o.useState(n?"initial":"unmounted"),[P,D]=o.useState("hidden"),[C,k]=o.useState(!n),[T,x]=o.useState("overlay"),M=o.useRef(null),R=o.useRef(null),O="bottom"===l,I={opening:()=>O?{from:{translateY:V()},to:{translateY:Z},options:{duration:ee}}:{from:{translateX:H()},to:{translateX:Z},options:{duration:ee}},closing:()=>O?{from:{translateY:Z},to:{translateY:V()},options:{duration:ee}}:{from:{translateX:Z},to:{translateX:H()},options:{duration:ee}}},{direction:j}=d.useUser(),H=()=>{return`${"right"===i.normalizePosition(l,j)?"":"-"}${e=M.current,Math.round(e.getBoundingClientRect().width)}px`;var e},V=()=>{return`${e=M.current,Math.round(e.offsetHeight)}px`;var e},{nodeRef:L}=b.useAnimation(v,{animationStates:I,isAnimatedOnMount:!0,onAnimationEnd:o.useCallback((()=>{"opening"===v?_?.(!0):n||(L(null),D("hidden"),N("unmounted"),_?.(!1))}),[v,n])});o.useEffect((()=>{if("unmounted"!==v||n){if("unmounted"!==v||!n)return"initial"===v&&n?(L(M.current),k(!1),void N("opening")):void("opening"===v&&n?D("visible"):n||(k(!0),N("closing")));N("initial")}}),[n,v]),o.useEffect((()=>{if("opening"===v){const e=a.getActiveElement();R.current=e===document.body?document.body:e,R.current?.addEventListener("keydown",X)}if("closing"===v)return()=>{R.current?.removeEventListener("keydown",X)}}),[v]);const X=e=>{R.current===a.getActiveElement()&&"F6"===e.code&&(e.preventDefault(),e.stopPropagation(),a.focusWithin(M.current))},Y=o.useCallback((e=>{const t=R.current;switch(e.code){case"Escape":A?.({reason:"escapeKey"});break;case"F6":e.preventDefault(),e.stopPropagation(),t&&a.focusOn(t)}}),[A]),z=o.useCallback((()=>{A?.({reason:"outsideClick"})}),[A]);u.useOutsideClick({isDisabled:C,ref:M,handler:z});const B=()=>{const e=$();"overlay"===T&&e<600&&x("fullOverlay"),"fullOverlay"===T&&e>600&&x("overlay")},W=y.getClientHints(),$=()=>"ios"===W.platform?document.documentElement.clientWidth:window.innerWidth;o.useEffect((()=>{if(M.current){const e=new ResizeObserver((()=>{B()}));return e.observe(document.body),()=>{e.unobserve(document.body)}}}),[B]);const{classes:K}=m.useComponentTheme(f.DrawerPopupRedwoodTheme,{placement:O?l:"rtl"===j?"start"===l?"right":"left":"start"===l?"left":"right",visibility:P,displayModeHorizontal:T}),q=[...Object.values(p.colorInterpolations)],G=h.mergeInterpolations(q),{...J}=G(g),Q=()=>t.jsx("div",{ref:M,className:K,style:J,tabIndex:-1,role:"dialog",onKeyDown:Y,"aria-label":F,"aria-labeledby":w,"aria-describedby":U,children:t.jsx(E.FocusTrap,{autoFocusRef:r,children:e})}),te="unmounted"!==v;return te?"modal"===c?t.jsx(S.Modal,{isOpen:te,children:Q()}):t.jsx(s.Layer,{children:Q()}):null},Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=UNSAFE_DrawerPopup.js.map
